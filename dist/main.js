(()=>{"use strict";async function n(n,t={},e=3e4){return await new Promise((async o=>{let r=new URLSearchParams(t).toString();r.length>0&&(r="?"+r),setTimeout((()=>{o(503)}),e);try{const t=await fetch(`https://ddu6.xyz/services/ph-get/${n}${r}`);if(200!==t.status)return void o(500);const{status:e,data:i}=await t.json();if(200===e)return void o({data:i});if("number"==typeof e)return void o(e)}catch(n){console.log(n)}o(500)}))}async function t(t,e,o){if(0===e.length||0===o.length)return 401;const r=await n(`local/ids${t}`,{token:e,password:o});return 503===r?503:401===r?401:"number"==typeof r?500:r.data}async function e(t,e,o){if(0===e.length||0===o.length)return 401;const r=await n(`local/cids${t}`,{token:e,password:o});return 503===r?503:401===r?401:"number"==typeof r?500:r.data}function o(n){const t=document.createElement("canvas");t.width=1e3,t.height=1e3,t.classList.add("idsDensityView");const e=t.getContext("2d");if(null===e)throw new Error;e.scale(10,10),e.fillStyle="rgb(30,30,30)",n=n.map((n=>n%1e4+1));for(let t=0;t<n.length;t++){const o=n[t]-1,r=o%100,i=(o-r)/100;e.fillRect(r,i,1,1)}e.fillStyle="grey";for(let n=0;n<10;n++){const t=10*n+9.9,o=10*n+9.9;e.fillRect(0,t,100,.1),e.fillRect(o,0,.1,100)}return t}function r(n,t){const e=1e4;n=n.map((n=>n%e)),t*=e;const o={};for(let t=0;t<n.length;t++)o[n[t]]=!0;let r=0;const i=[];for(let n=0;n<e;n++)o[n]&&(r!==n?(i.push({s:t+r,e:t+n-1}),r=n+1):r++);return r!==e&&i.push({s:t+r,e:t+e-1}),i.map((n=>{const{s:t,e}=n;return t===e?`#${t}`:`#${t}-${e}`})).join(" ")}document.head.innerHTML="<meta charset='utf8'>\n<meta name='viewport' content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=0'>\n<title>PKU Hole Analyzer</title>\n<link rel=\"icon\" href=\"https://cdn.jsdelivr.net/gh/ddu6/static@0.1.0/imgs/ph.png\" type=\"image/png\">",document.body.style.margin="0";const i=new class{constructor(){this.element=document.createElement("div"),this.style=document.createElement("style"),this.cmdInput=document.createElement("input"),this.console=document.createElement("div"),this.cmd="",this.token="",this.password="";const{element:n,style:t,cmdInput:e,console:o}=this;t.textContent='body {\n    --color-text: #cccccc;\n    --color-light: #8f8f8f;\n    --color-string: #df9e61;\n    --color-number: #B5CEA8;\n    --color-keyword: #cc80c6;\n    --color-function: #DCDCAA;\n    --color-variable: #6ec0ec;\n    --color-modifier: #3074ac;\n    --color-class: #4EC9B0;\n    --color-warn: #F44747;\n    --color-comment: #6A9955;\n    --color-border: #2e3133;\n    --color-bg: #131313;\n    --color-area: #161616;\n    --color-pre: #191b1d;\n    --color-slice: rgba(88, 88, 88, 0.5);\n    --color-selection: rgba(95, 144, 163, 0.5);\n    --color-span: rgba(58, 61, 65, 0.5);\n    --font: icomoon, "Segoe UI", "Microsoft YaHei", "Hiragino Sans GB", "STHeiti Light", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n    --length-width-side: 280px;\n    --length-width-bar: 15px;\n    --length-padding: 2em;\n    --length-padding-pre: 1em;\n    --length-padding-cell: .5em;\n    --length-padding-span: .3em;\n    --length-padding-circle: .2em;\n    --length-margin-title: 1em;\n    --length-margin-heading: .5em;\n    --length-margin-display: .25em;\n    --length-radius-pre: .5em;\n    --length-radius-span: .3em;\n    --length-font-title: 1.8em;\n    --length-font-heading: 1.3em;\n    --length-font-span: .85em;\n    --length-font-log: .8em;\n    --length-font-circle: .7em;\n    --length-space: .25em;\n    --length-space-gap: .5em;\n    --length-space-tab: 2em;\n    --number-ratio-line: 1.5;\n    line-height: var(--number-ratio-line);\n    font-family: var(--font);\n    color: var(--color-text);\n    background-color: var(--color-bg) !important;\n    font-size: 16px;\n}\n\n@media screen and (max-width:650px) {\n    body {\n        font-size: 15.5px\n    }\n}\n\n@media screen and (max-width:600px) {\n    body {\n        font-size: 15px\n    }\n}\n\n@media screen and (max-width:550px) {\n    body {\n        font-size: 14.5px\n    }\n}\n\n@media screen and (max-width:500px) {\n    body {\n        font-size: 14px\n    }\n}\n\n@media screen and (max-width:450px) {\n    body {\n        font-size: 13.5px\n    }\n}\n\n@media screen and (max-width:400px) {\n    body {\n        font-size: 13px\n    }\n}\n\n::-webkit-scrollbar {\n    background-color: transparent;\n}\n\n::-webkit-scrollbar-corner {\n    background-color: transparent;\n}\n\n::-webkit-scrollbar-thumb {\n    background-color: var(--color-slice);\n}\n\na {\n    color: inherit;\n    text-decoration: none;\n}\n\na[href] {\n    color: var(--color-modifier);\n}\n\na[href]:hover {\n    text-decoration: underline;\n}\n\nbutton,\ninput[type="button"],\ninput[type="reset"],\ninput[type="submit"],\n.button {\n    font: inherit;\n    color: var(--color-text);\n    border-radius: var(--length-radius-span);\n    padding: var(--length-padding-circle) var(--length-padding-pre);\n    background-color: var(--color-slice);\n    border: none;\n    outline: none;\n}\n\nbutton:hover,\ninput[type="button"]:hover,\ninput[type="reset"]:hover,\ninput[type="submit"]:hover,\n.button:hover {\n    background-color: var(--color-selection);\n}\n\nimg {\n    max-width: 100%;\n    max-height: 280vh;\n    filter: grayscale(50%) brightness(50%);\n    display: block;\n}\n\ninput,\nselect,\ntextarea,\n.input,\n.select,\n.textarea {\n    font: inherit;\n    color: var(--color-text);\n    padding: 0 var(--length-padding-circle);\n    margin: 0;\n    background-color: transparent;\n    border: 1px solid var(--color-border);\n    outline: none;\n    border-radius: var(--length-radius-span);\n}\n\ninput:focus,\nselect:focus,\ntextarea:focus,\n.input:focus,\n.select:focus,\n.textarea:focus {\n    border-color: var(--color-variable);\n}\n\nselect,\n.select {\n    padding: 0;\n}\n\ntextarea {\n    resize: none;\n}\n\n.console>.item{\n    margin-bottom: var(--length-margin-heading);\n}\n\n.idsDensityView{\n    display: block;\n    width: 500px;\n    max-width: 100%;\n}',e.addEventListener("keydown",(async n=>{"Enter"===n.key&&await this.exec()})),e.classList.add("cmd"),o.classList.add("console"),n.append(t),n.append(e),n.append(o)}async init(){const n=window.localStorage.getItem("ph-token");"string"==typeof n&&32===n.length&&(this.token=n);const t=window.localStorage.getItem("ph-password");"string"==typeof t&&t.length>0&&(this.password=t)}async exec(){const{cmdInput:n,console:t}=this,e=n.value.trim();n.value="",e.length>0&&(this.cmd=e);const{cmd:o}=this,r=document.createElement("div"),i=document.createElement("div");i.textContent=`${function(){const n=new Date;return[n.getMonth()+1,n.getDate()].map((n=>n.toString().padStart(2,"0"))).join("-")+" "+[n.getHours(),n.getMinutes(),n.getSeconds()].map((n=>n.toString().padStart(2,"0"))).join(":")+":"+n.getMilliseconds().toString().padStart(3,"0")}()}  ${o}`;const a=document.createElement("div");a.textContent="executing",i.classList.add("desc"),a.classList.add("content"),r.classList.add("item"),r.append(i),r.append(a),t.prepend(r);const s=await this.basicallyExec(o);if(s instanceof Error)return a.textContent="Error. "+s.message,void r.classList.add("err");"string"!=typeof s?(a.textContent="",a.append(s)):a.textContent=s}async basicallyExec(i){const{password:a,token:s}=this;if(0===a.length||0===s.length)return new Error("401.");if(i.startsWith("ids")){const n=Number(i.slice(3));if(isNaN(n))return new Error("Invalid cmd.");const e=await t(n,s,a);return 401===e&&(this.token="",this.password=""),"number"==typeof e?new Error(`${e}. Fail to get ids.`):o(e)}if(i.startsWith("cids")){const n=Number(i.slice(4));if(isNaN(n))return new Error("Invalid cmd.");const t=await e(n,s,a);return 401===t&&(this.token="",this.password=""),"number"==typeof t?new Error(`${t}. Fail to get cids.`):o(t)}if(i.startsWith("rids")){const n=Number(i.slice(4));if(isNaN(n))return new Error("Invalid cmd.");const e=await t(n,s,a);return 401===e&&(this.token="",this.password=""),"number"==typeof e?new Error(`${e}. Fail to get ids.`):r(e,n)}if(i.startsWith("rcids")){const n=Number(i.slice(5));if(isNaN(n))return new Error("Invalid cmd.");const t=await e(n,s,a);return 401===t&&(this.token="",this.password=""),"number"==typeof t?new Error(`${t}. Fail to get cids.`):r(t,n)}if("info"===i){const t=await async function(t,e){if(0===t.length||0===e.length)return 401;const o=await n("local/info",{token:t,password:e});return 503===o?503:401===o?401:"number"==typeof o?500:o.data}(s,a);if(401===t&&(this.token="",this.password=""),"number"==typeof t)return new Error(`${t}. Fail to get info.`);const{maxId:e,maxCId:o}=t;return`max-id ${e}, max-cid ${o}`}return new Error("Invalid cmd.")}};window.main=i,document.body.append(i.element),i.init()})();